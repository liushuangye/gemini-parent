(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45a28229"],{a358:function(e,t,i){"use strict";i("deb2")},b36a:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"usernamage"},[i("router-view"),i("div",{staticClass:"usernamage-wrap"},[i("div",{staticClass:"search"},[i("el-form",{attrs:{inline:!0}},[i("el-form-item",{attrs:{label:e.$t("workflow.modelName")}},[i("el-input",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.modelForm.templateName,callback:function(t){e.$set(e.modelForm,"templateName","string"===typeof t?t.trim():t)},expression:"modelForm.templateName"}})],1),i("el-form-item",{attrs:{"label-width":"1px"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.selectList()}}},[e._v(e._s(e.$t("common.btnFind")))]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.resetList()}}},[e._v(e._s(e.$t("common.btnReset")))]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.createBpmnModel()}}},[e._v(e._s(e.$t("workflow.create")))]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.showDialogVisible()}}},[e._v(e._s(e.$t("workflow.import")))]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.exportSelect()}}},[e._v(e._s(e.$t("workflow.export")))])],1)],1)],1),i("div",{staticClass:"line"}),i("div",{staticClass:"tabledata"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"Loading","max-height":e.tableHeight,border:"",stripe:"","header-cell-style":{background:"#E5E9EF",color:"#606266"}},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),i("el-table-column",{attrs:{type:"index",align:"center",index:e.indexMethod,label:e.$t("workflow.num"),width:"50"}}),i("el-table-column",{attrs:{align:"center",label:e.$t("workflow.model.id"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.id)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$t("workflow.model.name"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$t("workflow.model.version"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.version)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$t("workflow.model.description"),"min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.description)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$t("workflow.model.createTime"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.createTime)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$t("workflow.model.lastUpdateTime"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lastUpdateTime)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$t("workflow.model.deploymentId"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.deploymentId)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$t("common.operat"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"mini"},on:{click:function(i){return e.design(t.row.id)}}},[e._v(" "+e._s(e.$t("workflow.design"))+" ")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deploy(t.row.id)}}},[e._v(" "+e._s(e.$t("workflow.deploy"))+" ")]),i("el-button",{staticStyle:{"margin-left":"10px",color:"#F00"},attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteDate(t.row.id)}}},[e._v(" "+e._s(e.$t("common.delete"))+" ")])]}}])})],1)],1),i("div",{staticClass:"page"},[i("el-pagination",{attrs:{background:"","current-page":e.modelForm.pageNum,"page-sizes":[10,20,30,40],"page-size":e.modelForm.pageSize,layout:"total, sizes, prev, pager, next",total:e.listSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),i("el-dialog",{attrs:{visible:e.dialogVisible,title:e.$t("workflow.importBpmnModel"),width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{attrs:{"label-width":"25%"}},[i("el-form-item",{attrs:{label:e.$t("workflow.modelName")}},[i("el-input",{staticStyle:{width:"80%"},attrs:{size:"mini"},model:{value:e.modelName,callback:function(t){e.modelName=t},expression:"modelName"}})],1),i("el-form-item",{attrs:{label:e.$t("workflow.description")}},[i("el-input",{staticStyle:{width:"80%"},attrs:{size:"mini",type:"textarea",rows:3},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1),i("el-form-item",{attrs:{label:e.$t("workflow.selectFile")}},[i("div",[i("el-input",{staticStyle:{width:"80%",display:"inline-block"},attrs:{size:"mini",disabled:""},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(t){return e.fileSelect()}}},[e._v("...")]),i("input",{ref:"fileagain",staticClass:"upfile",staticStyle:{display:"none"},attrs:{type:"file",name:"file",accept:".xml"},on:{change:function(t){return e.changeInput()}}})],1)])],1),i("div",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.uploadFile()}}},[e._v(e._s(e.$t("common.btnConfirm")))]),i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("common.btnCancel")))])],1)],1)],1)],1)},o=[],l=i("1da1"),a=(i("96cf"),i("d3b7"),i("b0c0"),i("a4d3"),i("e01a"),i("ac1f"),i("1276"),i("5319"),i("3ca3"),i("ddb0"),i("2b3d"),i("bc3a"),i("b775"));function s(e){return Object(a["a"])({url:"/workflow/listModel",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/workflow/design?modelId="+e,method:"get"})}function c(e){return Object(a["a"])({url:"/workflow/deploy",method:"post",data:e})}function m(){return Object(a["a"])({url:"/workflow/create",method:"get"})}function d(e){return Object(a["a"])({url:"/workflow/importBpmnModel",method:"post",data:e})}function u(e){var t=e[0].id;return Object(a["a"])({url:"/workflow/exportByModelId?modelId="+t,method:"get"})}var f={data:function(){return{multipleSelection:[],listLoading:!0,list:[],tableHeight:0,listSize:0,modelForm:{templateName:"",pageNum:1,pageSize:20},dialogVisible:!1,fileName:"",modelName:"",description:""}},created:function(){var e=this,t=document.documentElement.clientHeight-200+"px";this.$nextTick((function(){e.tableHeight=t}))},mounted:function(){this.selectList();var e=this;window.onresize=function(){return function(){var t=document.documentElement.clientHeight-200+"px";e.tableHeight=t}()}},methods:{indexMethod:function(e){return(~~this.modelForm.pageNum-1)*this.modelForm.pageSize+e+1},handleSelectionChange:function(e){this.multipleSelection=e},selectList:function(){var e=this;this.listLoading=!0,s(this.modelForm).then((function(t){t.data&&"200"==t.code&&(console.log(t.data),e.list=t.data.records,e.listSize=t.data.total)})).finally((function(){e.listLoading=!1}))},resetList:function(){this.modelForm.templateName="",this.modelForm.pageNum=1,this.modelForm.pageSize=20,this.selectList()},deleteDate:function(e){var t=this;this.$confirm(this.$t("common.delConfirm"),this.$t("common.prompt"),{confirmButtonText:this.$t("common.btnConfirm"),cancelButtonText:this.$t("common.btnCancel"),cancelButtonClass:"bhh-btn-custom-cancel"}).then(Object(l["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.listLoading=!0,deleteTool(e).then((function(e){t.modelForm.pageNum=1,t.modelForm.pageSize=20,t.selectList(),0===e.code&&t.$message({type:"success",message:t.$t("common.deleteSuccess"),duration:1e3})})).finally((function(){t.listLoading=!1}));case 2:case"end":return i.stop()}}),i)}))))},handleSizeChange:function(e){this.modelForm.pageSize=e,this.selectList()},handleCurrentChange:function(e){this.modelForm.pageNum=e,this.selectList()},fileSelect:function(){this.$refs.fileagain.click()},changeInput:function(){var e=this.$refs.fileagain.files[0];this.fileName=e.name},uploadFile:function(){var e=this;""!==this.modelName?0!==this.$refs.fileagain.files.length?this.$confirm(this.$t("workflow.uplodeConfirm"),this.$t("common.prompt"),{confirmButtonText:this.$t("common.btnConfirm"),cancelButtonText:this.$t("common.btnCancel"),cancelButtonClass:"bhh-btn-custom-cancel"}).then(Object(l["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.listLoading=!0,i=new FormData,i.append("modelName",e.modelName),i.append("description",e.description),i.append("file",e.$refs.fileagain.files[0]),i.append("fileName",e.fileName),d(i).then((function(t){200==t.code&&(e.modelForm.pageNum=1,e.modelForm.pageSize=20,e.selectList(),e.$message({type:"success",message:e.$t("workflow.uplodeSuccess"),duration:1e3}))})).finally((function(){e.listLoading=!1,e.dialogVisible=!1}));case 7:case"end":return t.stop()}}),t)})))):this.$message({type:"warning",message:this.$t("workflow.selectNull"),duration:1e3}):this.$message({type:"warning",message:this.$t("workflow.modelNameNull"),duration:1e3})},showDialogVisible:function(){this.modelName="",this.fileName="",void 0!==this.$refs.fileagain&&(this.$refs.fileagain.value=""),this.dialogVisible=!0},createBpmnModel:function(){m()},design:function(e){r(e)},deploy:function(e){var t=this,i={modelId:e};c(i).then((function(e){200==e.code&&(t.selectList(),t.$message({type:"success",message:t.$t("workflow.deploySuccess"),duration:1e3}))}))},exportSelect:function(){u(this.multipleSelection).then((function(e){if(console.log(e),void 0!==e){var t=localStorage.getItem("content-disposition").split(";")[1].split("filename=")[1],i=decodeURIComponent(t);i=i.replace(/\"/g,"");var n=new Blob([e],{type:"application/xml;charset=UTF-8"}),o=document.createElement("a");o.download=i,o.href=window.URL.createObjectURL(n),o.click(),window.URL.revokeObjectURL(o.href)}}))}}},p=f,h=(i("a358"),i("2877")),g=Object(h["a"])(p,n,o,!1,null,"12a947d6",null);t["default"]=g.exports},deb2:function(e,t,i){}}]);