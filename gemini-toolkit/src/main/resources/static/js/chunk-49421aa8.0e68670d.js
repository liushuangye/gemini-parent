(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49421aa8"],{"5d2a":function(e,t,a){"use strict";a("f267")},8554:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container",staticStyle:{"font-size":"15px"}},[a("div",[a("span",[e._v(e._s(e.$t("devopstools.taskName"))+" :")]),a("el-input",{staticStyle:{width:"20%","margin-left":"10px"},attrs:{size:"mini",disabled:""},model:{value:e.devopsName,callback:function(t){e.devopsName=t},expression:"devopsName"}})],1),a("div",{staticStyle:{"margin-top":"10px"}},[a("span",{staticStyle:{"vertical-align":"top"}},[e._v(e._s(e.$t("devopstools.featuresDesc"))+" :")]),a("el-input",{staticStyle:{width:"40%","margin-left":"10px"},attrs:{type:"textarea",size:"mini",rows:3,disabled:""},model:{value:e.deptdesc,callback:function(t){e.deptdesc=t},expression:"deptdesc"}})],1),e._l(e.step,(function(t,s){return a("div",{key:s,staticStyle:{"margin-top":"20px"}},[a("el-card",{staticStyle:{width:"90%"}},[a("div",[a("div",{staticClass:"div-a"},[e._v(" "+e._s(e.$t("devopstools.step"))+e._s(t.id)+": "+e._s(t.name)+" ")]),a("div",{staticClass:"div-b"},["0"===e.execHis[t.id].status?a("el-button",{staticStyle:{color:"blue"},attrs:{round:"",size:"mini",disabled:""}},[e._v(e._s(e.statusText(t.id)))]):e._e(),"1"===e.execHis[t.id].status?a("el-button",{staticStyle:{color:"green"},attrs:{round:"",size:"mini",disabled:""}},[e._v(e._s(e.statusText(t.id)))]):e._e(),"2"===e.execHis[t.id].status?a("el-button",{staticStyle:{color:"red"},attrs:{round:"",size:"mini",disabled:""}},[e._v(e._s(e.statusText(t.id)))]):e._e()],1)]),a("div",{staticStyle:{"margin-top":"40px","margin-left":"40px"}},[a("div",{staticClass:"div-a"},[e._v(" "+e._s(e.$t("devopstools.description"))+": "+e._s(t.desc)+" ")]),a("div",{staticClass:"div-b"},[a("el-button",{attrs:{type:"primary",disabled:!("QUERY"===t.type||"0"===e.execHis[t.id].status),size:"mini"},on:{click:function(a){return e.execTask(t.id,e.execHis[t.id].execParam)}}},[e._v(e._s(e.$t("devopstools.execution")))]),"UPDATE"===t.type?a("el-button",{attrs:{disabled:"1"!=e.execHis[t.id].status,size:"mini"},on:{click:function(a){return e.execRollbackTask(t.id)}}},[e._v(e._s(e.$t("devopstools.revoke")))]):e._e()],1)]),a("div",{staticStyle:{"margin-top":"80px","margin-left":"40px"}},[e._v(" "+e._s(e.$t("devopstools.condition"))+": "),null!=t.paramsOfWhere?a("span",e._l(t.paramsOfWhere.param,(function(s,r){return a("span",{key:r},[e._v(" "+e._s(s.value)+": "),a("el-input",{staticStyle:{width:"17%","margin-left":"5px"},attrs:{placeholder:s.placeholder,size:"mini"},model:{value:e.execHis[t.id].execParam[s.key],callback:function(a){e.$set(e.execHis[t.id].execParam,s.key,a)},expression:"execHis[item.id].execParam[ment.key]"}})],1)})),0):e._e()]),"QUERY"===t.type?a("div",{staticStyle:{"margin-top":"20px","margin-left":"40px"},attrs:{gutter:20}},[e._v(" "+e._s(e.$t("devopstools.result"))+": "),null!=e.execHis[t.id].execData?a("span",e._l(e.execHis[t.id].execData,(function(s,r,n){return a("span",{key:n,staticClass:"usernamage"},[e._v(" "+e._s(r)+" "),a("div",{staticClass:"usernamage-wrap",staticStyle:{"margin-left":"40px","margin-top":"10px"}},[a("div",{staticClass:"tabledata"},[a("el-table",{ref:"multipleTable",refInFor:!0,staticStyle:{width:"100%"},attrs:{data:e.execHis[t.id].execData[r],stripe:"","element-loading-text":"Loading","max-height":"300","header-cell-style":{background:"#E5E9EF",color:"#606266"},border:""}},[e.execHis[t.id].execData[r].length>0?a("el-table-column",{attrs:{type:"index",align:"center",label:e.$t("devopstools.num"),width:"60"}}):e._e(),e._l(e.execHis[t.id].execData[r][0],(function(t,s,r){return a("el-table-column",{key:r,attrs:{align:"center",label:s,"min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row[s])+" ")]}}],null,!0)})}))],2)],1)])])})),0):e._e()]):e._e(),"UPDATE"===t.type?a("div",{staticStyle:{"margin-top":"20px","margin-left":"40px"},attrs:{gutter:20}},[e._v(" "+e._s(e.$t("devopstools.updated"))+": "),null!=t.paramsOfSet?a("span",{attrs:{span:20}},e._l(t.paramsOfSet.param,(function(s,r){return a("span",{key:r},[e._v(" "+e._s(s.value)+": "),a("el-input",{staticStyle:{width:"17%","margin-left":"5px"},attrs:{placeholder:s.placeholder,size:"mini"},model:{value:e.execHis[t.id].execParam[s.key],callback:function(a){e.$set(e.execHis[t.id].execParam,s.key,a)},expression:"execHis[item.id].execParam[ment.key]"}})],1)})),0):e._e()]):e._e()])],1)})),a("el-button",{staticStyle:{"margin-left":"45%","margin-top":"20px"},attrs:{type:"primary"},on:{click:function(t){return e.btnReturn()}}},[e._v(e._s(e.$t("common.btnReturn")))])],2)},r=[],n=a("1da1"),i=(a("96cf"),a("b0c0"),a("498a"),a("ac1f"),a("5319"),a("a6fe")),o=a("cf45"),c={data:function(){return{devopsName:"",deptdesc:"",step:[],execHis:{},execForm:{id:0,stepId:0,params:{}},rules:{},paramName:{}}},mounted:function(){this.getTool()},methods:{statusText:function(e){return"0"===this.execHis[e].status?this.$t("devopstools.notExecuted"):"1"===this.execHis[e].status?this.$t("devopstools.executed"):"2"===this.execHis[e].status?this.$t("devopstools.revoked"):void 0},getTool:function(){var e=this;Object(i["k"])(this.$route.params.taskId).then((function(t){if(t.data&&0===t.code){e.devopsName=t.data.name,e.deptdesc=t.data.desc,e.step=t.data.devops.steps.step,e.execHis=t.data.execHis;for(var a=0;a<e.step.length;a++)if(null==e.execHis[e.step[a].id].execParam){if(e.$set(e.execHis[e.step[a].id],"execParam",{}),null!=e.step[a].paramsOfWhere)for(var s=0;s<e.step[a].paramsOfWhere.param.length;s++)e.rules[e.step[a].paramsOfWhere.param[s].key]=e.step[a].paramsOfWhere.param[s].rules,e.paramName[e.step[a].paramsOfWhere.param[s].key]=e.step[a].paramsOfWhere.param[s].value,e.$set(e.execHis[e.step[a].id].execParam,e.step[a].paramsOfWhere.param[s].key,"");if(null!=e.step[a].paramsOfSet)for(var r=0;r<e.step[a].paramsOfSet.param.length;r++)e.rules[e.step[a].paramsOfSet.param[r].key]=e.step[a].paramsOfSet.param[r].rules,e.paramName[e.step[a].paramsOfSet.param[r].key]=e.step[a].paramsOfSet.param[r].value,e.$set(e.execHis[e.step[a].id].execParam,e.step[a].paramsOfSet.param[r].key,"")}else{if(null!=e.step[a].paramsOfWhere)for(var n=0;n<e.step[a].paramsOfWhere.param.length;n++)e.rules[e.step[a].paramsOfWhere.param[n].key]=e.step[a].paramsOfWhere.param[n].rules,e.paramName[e.step[a].paramsOfWhere.param[n].key]=e.step[a].paramsOfWhere.param[n].value;if(null!=e.step[a].paramsOfSet)for(var i=0;i<e.step[a].paramsOfSet.param.length;i++)e.rules[e.step[a].paramsOfSet.param[i].key]=e.step[a].paramsOfSet.param[i].rules,e.paramName[e.step[a].paramsOfSet.param[i].key]=e.step[a].paramsOfSet.param[i].value}}}))},execTask:function(e,t){var a=this;for(var s in t){if(t[s]=t[s].trim(),""===t[s])return void this.$message({type:"warning",message:this.$t("devopstools.paramsNull"),duration:1e3});switch(this.rules[s]){case"mobile":if(!Object(o["d"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3});break;case"tel":if(!Object(o["f"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3});break;case"mail":if(!Object(o["c"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3});break;case"date":if(!Object(o["a"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3});break;case"socialCreditCode":if(!Object(o["e"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3});break;case"fax":if(!Object(o["b"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3});break;case"zipCode":if(!Object(o["g"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3});break;case"telNum":if(!Object(o["d"])(t[s])&&!Object(o["f"])(t[s]))return void this.$message({type:"warning",message:this.$t("devopstools.wrongFormat").replace("{0}",this.paramName[s]),duration:1e3})}}this.$confirm(this.$t("devopstools.executionConfirm"),this.$t("common.prompt"),{confirmButtonText:this.$t("common.btnConfirm"),cancelButtonText:this.$t("common.btnCancel"),cancelButtonClass:"bhh-btn-custom-cancel"}).then(Object(n["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:a.execForm.id=a.$route.params.taskId,a.execForm.stepId=e,a.execForm.params=t,Object(i["e"])(a.execForm).then((function(e){0===e.code&&(a.getTool(),a.$message({type:"success",message:a.$t("devopstools.executionSuccess"),duration:1e3}))}));case 4:case"end":return s.stop()}}),s)}))))},execRollbackTask:function(e){var t=this;this.$confirm(this.$t("devopstools.revokeConfirm"),this.$t("common.prompt"),{confirmButtonText:this.$t("common.btnConfirm"),cancelButtonText:this.$t("common.btnCancel"),cancelButtonClass:"bhh-btn-custom-cancel"}).then(Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.execForm.id=t.$route.params.taskId,t.execForm.stepId=e,Object(i["d"])(t.execForm).then((function(e){0===e.code&&(t.getTool(),t.$message({type:"success",message:t.$t("devopstools.revokeSuccess"),duration:1e3}))}));case 3:case"end":return a.stop()}}),a)}))))},btnReturn:function(){this.$router.push({path:"/devopstools/task"})}}},p=c,d=(a("5d2a"),a("2877")),u=Object(d["a"])(p,s,r,!1,null,"6a199ead",null);t["default"]=u.exports},a6fe:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"g",(function(){return n})),a.d(t,"l",(function(){return i})),a.d(t,"m",(function(){return o})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return p})),a.d(t,"f",(function(){return d})),a.d(t,"i",(function(){return u})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return m})),a.d(t,"k",(function(){return f})),a.d(t,"j",(function(){return v})),a.d(t,"b",(function(){return h}));var s=a("b775");function r(e){return Object(s["a"])({url:"/devops/getByPage",method:"post",data:e})}function n(e){return Object(s["a"])({url:"/devops/getById?id="+e,method:"get"})}function i(e){return Object(s["a"])({url:"/devops/importTemplate",method:"post",data:e})}function o(e){return Object(s["a"])({url:"/devops/updateTemplate",method:"post",data:e})}function c(e){return Object(s["a"])({url:"/devops/task/execStep",method:"post",data:e})}function p(e){return Object(s["a"])({url:"/devops/deleteToolkitById?id="+e,method:"delete"})}function d(){return Object(s["a"])({url:"/devops/getAllDevops",method:"get"})}function u(e){return Object(s["a"])({url:"/devops/task/getByPage",method:"post",data:e})}function l(e){return Object(s["a"])({url:"/devops/task/createTask",method:"post",data:e})}function m(e){return Object(s["a"])({url:"/devops/task/execRollback",method:"post",data:e})}function f(e){return Object(s["a"])({url:"/devops/task/getTaskById?id="+e,method:"get"})}function v(e){return Object(s["a"])({url:"/devops/log/details?id="+e,method:"get"})}function h(e){return Object(s["a"])({url:"/devops/task/deleteTask?id="+e,method:"delete"})}},cf45:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"f",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"e",(function(){return p})),a.d(t,"b",(function(){return d})),a.d(t,"g",(function(){return u}));var s=a("5530");a("ac1f"),a("5319"),a("4d63"),a("25f0");function r(e){var t={date:new Date,formatStr:"yyyy-MM-dd HH:mm:ss"};e=Object(s["a"])(Object(s["a"])({},t),e);var a=e.date,r=e.formatStr,n=new Date(a).getTime();a=new Date(n),r=r.replace(new RegExp("yyyy"),"".concat(a.getFullYear()));var i=a.getMonth()+1;r=r.replace(new RegExp("MM"),"".concat(i>9?i:"0"+i));var o=a.getDate();r=r.replace(new RegExp("dd"),"".concat(o>9?o:"0"+o));var c=a.getHours();r=r.replace(new RegExp("HH"),"".concat(c>9?c:"0"+c));var p=a.getMinutes();r=r.replace(new RegExp("mm"),"".concat(p>9?p:"0"+p));var d=a.getSeconds();return r=r.replace(new RegExp("ss"),"".concat(d>9?d:"0"+d)),r}function n(e){return!!/(^0?[1][0-9]{10}$)/.test(e)}function i(e){return!!/^(((0[1-9]{3})?(0[12][0-9])?[-])?\d{6,8})?(0?[1][35678][0-9]{9})?(-\d{1,6})?$/.test(e)}function o(e){return!!/\w{1,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/.test(e)}function c(e){return!!/\d{4}\/\d{1,2}\/\d{1,2}/.test(e)}function p(e){return!!/[1-9A-GY]{1}[1239]{1}[1-5]{1}[0-9]{5}[0-9A-Z]{10}/.test(e)}function d(e){return!!/^[a-zA-Z0-9\(\)\-\.|,+_&\/ ]+$/.test(e)}function u(e){return!!/^[a-zA-Z0-9\(\)\-\.|_&\/ ]+$/.test(e)}},f267:function(e,t,a){}}]);